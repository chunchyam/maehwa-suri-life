<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>평생대운</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 20px;
      background: #f9f9f9;
      color: #333;
    }
    .container {
      max-width: 800px;
      margin: auto;
      background: #fff;
      padding: 20px;
      border-radius: 6px;
      box-shadow: 0 2px 6px rgba(0,0,0,0.1);
    }
    h1 {
      text-align: center;
    }
    label {
      display: block;
      margin-top: 10px;
      margin-bottom: 5px;
    }
    select, input[type="number"] {
      padding: 5px;
      font-size: 1em;
      margin-right: 10px;
    }
    button {
      margin-top: 15px;
      padding: 10px 20px;
      background: #007BFF;
      color: #fff;
      border: none;
      border-radius: 4px;
      cursor: pointer;
    }
    table {
      margin-top: 20px;
      border-collapse: collapse;
      width: 100%;
    }
    table, th, td {
      border: 1px solid #ccc;
    }
    th, td {
      padding: 10px;
      text-align: center;
      vertical-align: middle;
    }
    .value {
      font-size: 1.2em;
      font-weight: bold;
      color: #333;
    }
    .small-text {
      font-size: 0.9em;
      color: #555;
      margin-top: 5px;
    }
  </style>
</head>
<body>
<div class="container">
  <h1>평생대운</h1>
  
  <!-- 천간 선택 -->
  <label>출생년도 천간 (갑=1, 을=2, …, 계=10):</label>
  <select id="cheongan">
    <option value="1">갑(1)</option>
    <option value="2">을(2)</option>
    <option value="3">병(3)</option>
    <option value="4">정(4)</option>
    <option value="5">무(5)</option>
    <option value="6">기(6)</option>
    <option value="7">경(7)</option>
    <option value="8">신(8)</option>
    <option value="9">임(9)</option>
    <option value="1">계(1)</option>
  </select>
  
  <!-- 지지 선택 -->
  <label>출생년도 지지 (자=1, 축=2, …, 해=12):</label>
  <select id="yearZhi">
    <option value="1">자(1)</option>
    <option value="2">축(2)</option>
    <option value="3">인(3)</option>
    <option value="4">묘(4)</option>
    <option value="5">진(5)</option>
    <option value="6">사(6)</option>
    <option value="7">오(7)</option>
    <option value="8">미(8)</option>
    <option value="9">신(9)</option>
    <option value="1">유(1)</option>
    <option value="2">술(2)</option>
    <option value="3">해(3)</option>
  </select>
  
  <!-- 음력 생월을 숫자 입력 -->
  <label>음력 생월 (숫자 입력):</label>
  <input type="number" id="monthZhi" min="1" max="12" value="3">
  
  <!-- 음력 생일을 숫자 입력 -->
  <label>음력 생일 (숫자 입력):</label>
  <input type="number" id="dayZhi" min="1" max="31" value="25">
  
  <!-- 생시 지지 선택 -->
  <label>생시 지지 (자=1, 축=2, …, 해=12):</label>
  <select id="timeZhi">
    <option value="1">자(1)</option>
    <option value="2">축(2)</option>
    <option value="3">인(3)</option>
    <option value="4">묘(4)</option>
    <option value="5">진(5)</option>
    <option value="6">사(6)</option>
    <option value="7">오(7)</option>
    <option value="8">미(8)</option>
    <option value="9">신(9)</option>
    <option value="1">유(1)</option>
    <option value="2">술(2)</option>
    <option value="3">해(3)</option>
  </select>
  
  <hr>
  
  <!-- 평생수리(1번)는 직접 입력 -->
  <label>평생수리 (1번, 직접 입력):</label>
  <input type="number" id="pSuri" min="1" max="9" value="3">
  
  <button onclick="calculateTable()">표 생성하기</button>
  
  <div id="resultArea"></div>
</div>

<script>
  // mod9 함수: 입력 n을 9로 나눈 나머지가 0이면 9 반환 (즉, 결과값은 1~9)
  function mod9(n) {
    const r = n % 9;
    return r === 0 ? 9 : r;
  }
  
  // 평생대운(2번) 계산: (천간 + 출생년도 지지 + 음력 생월 + 음력 생일 + 생시 지지)를 mod9 처리
  function getDaeyun() {
    const cVal = parseInt(document.getElementById("cheongan").value);
    const yVal = parseInt(document.getElementById("yearZhi").value);
    const mVal = parseInt(document.getElementById("monthZhi").value);
    const dVal = parseInt(document.getElementById("dayZhi").value);
    const tVal = parseInt(document.getElementById("timeZhi").value);
    const sum = cVal + yVal + mVal + dVal + tVal;
    return mod9(sum);
  }
  
  // 표 생성 함수  
  // 공식:
  // 1번 = 평생수리 (직접 입력)
  // 2번 = 평생대운 = getDaeyun() (mod9 처리)
  // 3 = 1+2, 4 = 1+3, 5 = 2+3, 6 = 4+5, 7 = 4+6, 8 = 5+6, 9 = 7+8,
  // 10 = 1+4+7, 11 = 2+5+8, 12 = 10+11
  // 각 계산 단계마다 mod9 적용
  function calculateTable(){
    const suri = mod9(parseInt(document.getElementById("pSuri").value));  // 1번
    const daeyun = mod9(getDaeyun());                                    // 2번
    
    const v3  = mod9(suri + daeyun);           // 3 = 1+2
    const v4  = mod9(suri + v3);               // 4 = 1+3
    const v5  = mod9(daeyun + v3);             // 5 = 2+3
    const v6  = mod9(v4 + v5);                 // 6 = 4+5
    const v7  = mod9(v4 + v6);                 // 7 = 4+6
    const v8  = mod9(v5 + v6);                 // 8 = 5+6
    const v9  = mod9(v7 + v8);                 // 9 = 7+8
    const v10 = mod9(suri + v4 + v7);          // 10 = 1+4+7
    const v11 = mod9(daeyun + v5 + v8);        // 11 = 2+5+8
    const v12 = mod9(v10 + v11);               // 12 = 10+11
    
    const resultValues = [suri, daeyun, v3, v4, v5, v6, v7, v8, v9, v10, v11, v12];
    
    // 기존 labelTable(수식 레이블)는 그대로 유지
    const labelTable = [
      ["인", "묘", "진"],
      ["사", "오", "미"],
      ["신", "유", "술"],
      ["해", "자", "축"]
    ];
    
    // 전역 카운터: 전체 셀에 대해 연속 번호 생성 (1부터 시작)
    let counter = 1;
    
    // 4행×3열 표 생성: 각 셀에 결과값와 동적 레이블을 함께 출력
    let html = '<h2>계산 결과</h2><table>';
    let idx = 0;
    for (let row = 0; row < 4; row++) {
      html += '<tr>';
      for (let col = 0; col < 3; col++) {
        const label = labelTable[row][col];
        const val = resultValues[idx];
        // 동적 레이블 생성: val 개의 연속된 번호 범위
        let startVal = counter;
        let endVal = counter + val - 1;
        let dynLabel = (val === 1) ? String(startVal) : startVal + "~" + endVal;
        counter = endVal + 1;
        
        html += `<td id="cell-${idx}">
                   <div class="formula">${label}</div>
                   <div class="value">${val}</div>
                   <div class="small-text">${dynLabel}</div>
                 </td>`;
        idx++;
      }
      html += '</tr>';
    }
    html += '</table>';
    
    document.getElementById("resultArea").innerHTML = html;
  }
</script>
</body>
</html>
